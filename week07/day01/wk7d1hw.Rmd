---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidyverse)
library(tsibbledata)
library(lubridate)
```

```{r}
nyc_bikes_df <- nyc_bikes
```

```{r}
nyc_bikes_df <- nyc_bikes_df %>% 
  mutate(
    age = round(year(today()) - birth_year),
    month = month(start_time, label = T),
    day_of_week = wday(start_time, label = T, 
                       week_start = 1),
    hour = hour(start_time),
    duration = as.period(interval(start_time, stop_time))
  )
```


```{r}
#most used start stations
nyc_bikes_df %>% 
  group_by(start_station) %>% 
  summarise(count = n()) %>% 
              arrange(desc(count))
```

```{r}
#most used end stations

nyc_bikes_df %>% 
  group_by(end_station) %>% 
  summarise(count = n()) %>% 
              arrange(desc(count))

```

```{r}
#male/female ratio
nyc_bikes_df %>% 
  group_by(gender) %>% 
  summarise(count = n())
```


```{r}
nyc_bikes_df %>% 
  group_by(age, gender) %>% 
  filter(gender %in% c("Male", "Female")) %>%
  summarise(count = n()) %>% 
  ggplot(aes(x = age, y = count, colour = gender)) +
  geom_line()
```

```{r}
#monthly usage
nyc_bikes_df %>% 
  group_by(month) %>% 
  summarise(count = n()) %>% 
  ggplot(aes(x = month, y = count)) +
  geom_col(fill = "blue3", col = "black")
```


```{r}
#daily usage
nyc_bikes_df %>% 
  group_by(day_of_week) %>% 
  summarise(count = n()) %>% 
  ggplot(aes(x = day_of_week, y = count)) +
  geom_col(fill = "blue3", col = "black") +
  labs(
    x = "Day of Week"
  )
```

```{r}
nyc_bikes_df %>% 
  group_by(type) %>% 
  summarise(count = n())
```


```{r}
#hourly usage
nyc_bikes_df %>% 
  group_by(hour, gender) %>% 
  summarise(count = n()) %>%
  filter(gender %in% c("Male", "Female")) %>%
  ggplot() +
  geom_line(aes(x = hour, y = count, colour = gender)) +
 scale_x_continuous(
    breaks = seq(0,23, by = 1)
    ) +
     scale_y_continuous(
    breaks = seq(0,600, by = 50)
    )
```

